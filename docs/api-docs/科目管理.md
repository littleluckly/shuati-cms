# 科目管理 API

本文档包含所有与科目管理相关的 API 接口。

## 基本科目操作

以下接口用于科目数据的增删改操作：

## 1. 新增科目

**接口地址**: `POST /subjects`

**接口描述**: 创建一个新的科目

**请求参数**: 表单数据
| 参数名 | 类型 | 位置 | 必填 | 说明 |
|--------|------|------|------|------|
| name | string | body | 是 | 科目名称 |
| code | string | body | 是 | 科目代码（唯一标识） |
| description | string | body | 否 | 科目描述 |
| tags | array | body | 否 | 科目标签列表，格式为 [{name: string, type: string}] |
| userTags | array | body | 否 | 用户自定义标签列表 |
| difficultyLevels | array | body | 否 | 难度等级列表 |
| isEnabled | boolean | body | 否 | 是否启用，默认为 true |

**请求示例**:

```
POST http://localhost:3000/subjects
Content-Type: application/json

{
  "name": "前端开发面试",
  "code": "FE_INTERVIEW",
  "description": "涵盖 JS、CSS、Vue、React 等",
  "tags": [
    { "name": "JavaScript", "type": "language" },
    { "name": "CSS", "type": "style" }
  ],
  "isEnabled": true
}
```

**响应示例**:

```json
{
  "success": true,
  "data": {
    "_id": "64f1a2b3c4d5e6f789012345",
    "name": "前端开发面试",
    "code": "FE_INTERVIEW",
    "description": "涵盖 JS、CSS、Vue、React 等",
    "tags": [
      { "name": "JavaScript", "type": "language" },
      { "name": "CSS", "type": "style" }
    ],
    "userTags": [],
    "difficultyLevels": [],
    "isEnabled": true,
    "isDeleted": false,
    "createdAt": "2023-09-01T00:00:00.000Z",
    "updatedAt": "2023-09-01T00:00:00.000Z"
  },
  "message": "科目创建成功"
}
```

**错误响应**:

```json
{ "success": false, "data": null, "message": "创建失败：科目代码已存在" }
```

## 2. 修改科目

**接口地址**: `PUT /subjects/:id`

**接口描述**: 更新指定科目的信息

**请求参数**:
| 参数名 | 类型 | 位置 | 必填 | 说明 |
|--------|------|------|------|------|
| id | string | path | 是 | 科目 ID |
| name | string | body | 否 | 科目名称 |
| description | string | body | 否 | 科目描述 |
| tags | array | body | 否 | 科目标签列表 |
| userTags | array | body | 否 | 用户自定义标签列表 |
| difficultyLevels | array | body | 否 | 难度等级列表 |
| isEnabled | boolean | body | 否 | 是否启用 |

**请求示例**:

```
PUT http://localhost:3000/subjects/64f1a2b3c4d5e6f789012345
Content-Type: application/json

{
  "name": "前端开发面试题",
  "description": "涵盖最新前端技术面试题"
}
```

**响应示例**:

```json
{
  "success": true,
  "data": {
    "_id": "64f1a2b3c4d5e6f789012345",
    "name": "前端开发面试题",
    "code": "FE_INTERVIEW",
    "description": "涵盖最新前端技术面试题",
    "tags": [
      { "name": "JavaScript", "type": "language" },
      { "name": "CSS", "type": "style" }
    ],
    "userTags": [],
    "difficultyLevels": [],
    "isEnabled": true,
    "isDeleted": false,
    "createdAt": "2023-09-01T00:00:00.000Z",
    "updatedAt": "2023-09-02T00:00:00.000Z"
  },
  "message": "科目更新成功"
}
```

**错误响应**:

```json
{ "success": false, "data": null, "message": "科目不存在" }
```

## 3. 删除科目

**接口地址**: `DELETE /subjects/:id`

**接口描述**: 软删除指定科目（标记为已删除，但保留数据）

**请求参数**:
| 参数名 | 类型 | 位置 | 必填 | 说明 |
|--------|------|------|------|------|
| id | string | path | 是 | 科目 ID |

**请求示例**:

```
DELETE http://localhost:3000/subjects/64f1a2b3c4d5e6f789012345
```

**响应示例**:

```json
{ "success": true, "data": null, "message": "科目删除成功" }
```

**错误响应**:

```json
{ "success": false, "data": null, "message": "科目不存在" }
```

## 科目查询接口

以下接口用于查询科目相关数据：

## 4. 获取所有科目

**接口地址**: `GET /subjects`

**接口描述**: 获取所有启用状态的科目列表（支持分页）

**请求参数**:
| 参数名 | 类型 | 位置 | 必填 | 说明 |
|--------|------|------|------|------|
| page | number | query | 否 | 当前页码，默认为 1 |
| limit | number | query | 否 | 每页显示条数，默认为 20，最大为 100 |

**请求示例**:

```
GET http://localhost:3000/subjects?page=1&limit=10
```

**响应示例**:

```json
{
  "success": true,
  "data": {
    "subjects": [
      {
        "_id": "64f1a2b3c4d5e6f789012345",
        "name": "前端开发面试",
        "code": "FE_INTERVIEW",
        "description": "涵盖 JS、CSS、Vue、React 等",
        "tags": [
          { "name": "JavaScript", "type": "language" },
          { "name": "CSS", "type": "style" },
          { "name": "React", "type": "framework" },
          { "name": "Vue", "type": "framework" },
          { "name": "工程化", "type": "tooling" }
        ],
        "userTags": [
          { "name": "面试重点", "type": "priority" },
          { "name": "高频题", "type": "frequency" }
        ],
        "difficultyLevels": ["简单", "中等", "困难"],
        "isEnabled": true,
        "createdAt": "2023-09-01T00:00:00.000Z",
        "updatedAt": "2023-09-01T00:00:00.000Z"
      }
    ],
    "pagination": {
      "page": 1,
      "limit": 10,
      "total": 50,
      "totalPages": 5,
      "hasNext": true,
      "hasPrev": false
    },
    "filters": {
      "isEnabled": true
    }
  },
  "message": "操作成功"
}
```

**分页字段说明**:

- `pagination.total`: 总记录数
- `pagination.page`: 当前页码
- `pagination.limit`: 每页显示条数
- `pagination.totalPages`: 总页数

## 5. 获取所有科目详细信息

**接口地址**: `GET /subjects/all`

**接口描述**: 获取所有启用状态的科目列表，包含题目统计信息（支持分页）

**请求参数**:
| 参数名 | 类型 | 位置 | 必填 | 说明 |
|--------|------|------|------|------|
| page | number | query | 否 | 当前页码，默认为 1 |
| limit | number | query | 否 | 每页显示条数，默认为 20，最大为 100 |

**请求示例**:

```
GET http://localhost:3000/subjects/all?page=1&limit=10
```

**响应示例**:

```json
{
  "success": true,
  "data": {
    "subjects": [
      {
        "_id": "64f1a2b3c4d5e6f789012345",
        "name": "前端开发面试",
        "code": "FE_INTERVIEW",
        "description": "涵盖 JS、CSS、Vue、React 等",
        "tags": [
          { "name": "JavaScript", "type": "language" },
          { "name": "CSS", "type": "style" },
          { "name": "React", "type": "framework" },
          { "name": "Vue", "type": "framework" },
          { "name": "工程化", "type": "tooling" }
        ],
        "userTags": [
          { "name": "面试重点", "type": "priority" },
          { "name": "高频题", "type": "frequency" }
        ],
        "difficultyLevels": ["简单", "中等", "困难"],
        "isEnabled": true,
        "createdAt": "2023-09-01T00:00:00.000Z",
        "updatedAt": "2023-09-01T00:00:00.000Z",
        "questionCount": 120,
        "difficultyCount": {
          "easy": 40,
          "medium": 50,
          "hard": 30
        }
      }
    ],
    "pagination": {
      "page": 1,
      "limit": 10,
      "total": 50,
      "totalPages": 5,
      "hasNext": true,
      "hasPrev": false
    },
    "filters": {
      "isEnabled": true
    }
  },
  "message": "操作成功"
}
```

**字段说明**:

- `questionCount`: 该科目的题目总数
- `difficultyCount`: 各难度等级的题目数量

## 6. 根据 ID 获取科目详情

**接口地址**: `GET /subjects/:id`

**接口描述**: 根据科目 ID 获取科目详情

**请求参数**:
| 参数名 | 类型 | 位置 | 必填 | 说明 |
|--------|------|------|------|------|
| id | string | path | 是 | 科目 ID |

**请求示例**:

```
GET http://localhost:3000/subjects/64f1a2b3c4d5e6f789012345
```

**响应示例**:

```json
{
  "success": true,
  "data": {
    "_id": "64f1a2b3c4d5e6f789012345",
    "name": "前端开发面试",
    "code": "FE_INTERVIEW",
    "description": "涵盖 JS、CSS、Vue、React 等",
    "tags": [
      { "name": "JavaScript", "type": "language" },
      { "name": "CSS", "type": "style" },
      { "name": "React", "type": "framework" },
      { "name": "Vue", "type": "framework" },
      { "name": "工程化", "type": "tooling" }
    ],
    "userTags": [
      { "name": "面试重点", "type": "priority" },
      { "name": "高频题", "type": "frequency" }
    ],
    "difficultyLevels": ["简单", "中等", "困难"],
    "isEnabled": true,
    "createdAt": "2023-09-01T00:00:00.000Z",
    "updatedAt": "2023-09-01T00:00:00.000Z"
  },
  "message": "操作成功"
}
```

**错误响应**:

```json
{ "success": false, "data": null, "message": "科目不存在" }
```

## 7. 根据科目 ID 获取所有标签

**接口地址**: `GET /subjects/:id/tags`

**接口描述**: 根据科目 ID 获取该科目下的所有标签列表

**请求参数**:
| 参数名 | 类型 | 位置 | 必填 | 说明 |
|--------|------|------|------|------|
| id | string | path | 是 | 科目 ID |

**请求示例**:

```
GET http://localhost:3000/subjects/64f1a2b3c4d5e6f789012345/tags
```

**响应示例**:

```json
{
  "success": true,
  "data": [
    { "name": "JavaScript", "type": "language" },
    { "name": "CSS", "type": "style" },
    { "name": "React", "type": "framework" },
    { "name": "Vue", "type": "framework" },
    { "name": "工程化", "type": "tooling" }
  ],
  "message": "操作成功"
}
```

## 8. 根据科目 ID 获取标签计数

**接口地址**: `GET /subjects/:id/tags-count`

**接口描述**: 根据科目 ID 获取该科目下的标签统计信息

**请求参数**:
| 参数名 | 类型 | 位置 | 必填 | 说明 |
|--------|------|------|------|------|
| id | string | path | 是 | 科目 ID |

**请求示例**:

```
GET http://localhost:3000/subjects/64f1a2b3c4d5e6f789012345/tags-count
```

**响应示例**:

```json
{
  "success": true,
  "data": [
    { "name": "JavaScript", "count": 45 },
    { "name": "CSS", "count": 30 },
    { "name": "React", "count": 25 },
    { "name": "Vue", "count": 20 },
    { "name": "工程化", "count": 15 }
  ],
  "message": "操作成功"
}
```

**字段说明**:

- `count`: 该标签下的题目数量
